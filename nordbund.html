<!doctype html>
<html lang="de">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>NordBund Suite - Extreme Precision</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@200;400;800&family=Space+Grotesk:wght@300;700&display=swap');

        :root {
            --nord-black: #050505;
            --nord-white: #ffffff;
            --nord-blue: #2563eb;
            --nord-grey: #1a1a1a;
        }

        body {
            background-color: var(--nord-white);
            color: var(--nord-black);
            font-family: 'Plus Jakarta Sans', sans-serif;
            overflow-x: hidden;
        }

        .font-display { font-family: 'Space Grotesk', sans-serif; }

        .giant-text {
            font-size: 15vw;
            line-height: 0.8;
            letter-spacing: -0.05em;
            font-weight: 800;
            text-transform: uppercase;
        }

        .scroll-section {
            position: relative;
            min-height: 100vh;
            padding: 10vh 5vw;
            display: flex;
            flex-direction: column;
            justify-content: center;
        }

        .sticky-container {
            position: sticky;
            top: 0;
            height: 100vh;
            overflow: hidden;
            display: flex;
            align-items: center;
        }

        .app-container {
            position: relative;
            width: 100%;
            max-width: 900px;
            margin: 0 auto;
            perspective: 2000px;
        }

        .layer {
            transition: transform 0.45s cubic-bezier(0.16, 1, 0.3, 1), opacity 0.45s cubic-bezier(0.16, 1, 0.3, 1);
            box-shadow: 0 50px 100px rgba(0, 0, 0, 0.1);
            will-change: transform, opacity;
        }

        .layer-backend {
            position: absolute;
            top: 40px;
            left: -40px;
            width: 100%;
            height: 100%;
            background: var(--nord-black);
            border-radius: 20px;
            z-index: 1;
            opacity: 0;
            transform: translateZ(-200px) rotateX(20deg);
        }

        .layer-frontend {
            position: relative;
            background: white;
            border: 1px solid #eee;
            border-radius: 20px;
            z-index: 2;
            padding: 2rem;
        }

        .floating-accent {
            position: absolute;
            font-weight: 800;
            font-size: 8vw;
            color: rgba(0, 0, 0, 0.03);
            z-index: -1;
            pointer-events: none;
            white-space: nowrap;
        }

        .bg-transition {
            transition: background-color 0.8s ease, color 0.8s ease;
        }

        .dark-mode {
            background-color: var(--nord-black) !important;
            color: var(--nord-white) !important;
        }

        .bar-chart {
            display: flex;
            align-items: flex-end;
            gap: 8px;
            height: 150px;
        }

        .bar {
            flex: 1;
            background: var(--nord-blue);
            border-radius: 4px;
            height: 0%;
            transition: height 1.5s cubic-bezier(0.16, 1, 0.3, 1);
            will-change: height;
        }

        .step {
            transition: opacity 0.35s ease;
            will-change: opacity;
        }

        #progress {
            transform-origin: left center;
            will-change: transform;
        }

        .lang-switch {
            border: 1px solid rgba(255, 255, 255, 0.4);
            border-radius: 999px;
            overflow: hidden;
            display: inline-flex;
        }

        .lang-btn {
            border: 0;
            background: transparent;
            color: white;
            font-size: 10px;
            font-weight: 700;
            letter-spacing: 0.1em;
            text-transform: uppercase;
            padding: 6px 10px;
            cursor: pointer;
            opacity: 0.65;
        }

        .lang-btn.is-active {
            background: rgba(255, 255, 255, 0.18);
            opacity: 1;
        }

        ::-webkit-scrollbar { width: 6px; }
        ::-webkit-scrollbar-track { background: transparent; }
        ::-webkit-scrollbar-thumb { background: #ddd; border-radius: 10px; }
    </style>
</head>
<body class="bg-transition">

    <div id="progress" class="fixed top-0 left-0 h-1 bg-blue-600 z-[100]" style="transform: scaleX(0)"></div>

    <nav class="fixed top-0 w-full z-[90] p-10 flex justify-between items-center mix-blend-difference text-white">
        <div class="font-bold text-2xl tracking-tighter uppercase">NordBund.</div>
        <div class="flex items-center gap-8 text-xs font-bold tracking-widest uppercase opacity-60 hover:opacity-100 transition">
            <div class="lang-switch" role="group" aria-label="Language switch">
                <button class="lang-btn is-active" type="button" data-lang="de">DE</button>
                <button class="lang-btn" type="button" data-lang="en">EN</button>
            </div>
        </div>
    </nav>

    <section class="scroll-section">
        <div class="floating-accent" style="top: 10%; right: -10%;" data-i18n="heroAccent">PRECISION</div>
        <div class="max-w-7xl mx-auto w-full">
            <h1 class="giant-text font-display">NORD<br><span class="text-blue-600">BUND.</span></h1>
            <div class="mt-20 flex flex-col md:flex-row gap-20 items-end">
                <p class="text-2xl font-light max-w-xl leading-snug" data-i18n-html="heroCopy">Die Suite für <span class="font-bold underline">Schadensanalyse</span>. Kompromisslose Geschwindigkeit durch Rust, absolute Eleganz durch React.</p>
                <div class="flex-grow border-b border-black mb-4 opacity-20"></div>
                <div class="text-xs font-bold uppercase tracking-widest" data-i18n="heroBuild">v1.2.0 Build 2026</div>
            </div>
        </div>
    </section>

    <section id="scrolly-trigger" class="relative" style="height: 300vh;">
        <div class="sticky-container">
            <div class="max-w-7xl mx-auto w-full grid md:grid-cols-2 gap-20 items-center px-10">
                <div class="app-container">
                    <div id="layer-back" class="layer layer-backend flex items-center justify-center p-10">
                        <div class="text-blue-500 font-mono text-sm leading-relaxed opacity-40">
                            fn main() { <br>
                            &nbsp;&nbsp;let data = load_claims(); <br>
                            &nbsp;&nbsp;analyze_safety(data); <br>
                            }
                        </div>
                        <div class="absolute bottom-6 right-6 text-white font-bold opacity-20" data-i18n="backendLabel">RUST BACKEND</div>
                    </div>
                    <div id="layer-front" class="layer layer-frontend shadow-2xl">
                        <div class="flex gap-2 mb-6">
                            <div class="w-3 h-3 rounded-full bg-red-400"></div>
                            <div class="w-3 h-3 rounded-full bg-yellow-400"></div>
                            <div class="w-3 h-3 rounded-full bg-green-400"></div>
                        </div>
                        <div class="space-y-6">
                            <div class="h-4 w-1/3 bg-slate-100 rounded"></div>
                            <div class="bar-chart" id="chart">
                                <div class="bar" style="--h: 60%"></div>
                                <div class="bar" style="--h: 40%"></div>
                                <div class="bar" style="--h: 85%"></div>
                                <div class="bar" style="--h: 50%"></div>
                                <div class="bar" style="--h: 75%"></div>
                            </div>
                            <div class="grid grid-cols-2 gap-4">
                                <div class="h-20 bg-slate-50 rounded-xl border border-slate-100 p-4">
                                    <div class="text-[10px] uppercase font-bold text-slate-400 mb-1" data-i18n="kpiLabel">Total KPI</div>
                                    <div class="text-xl font-bold">€ 1.2M</div>
                                </div>
                                <div class="h-20 bg-slate-50 rounded-xl border border-slate-100 p-4">
                                    <div class="text-[10px] uppercase font-bold text-slate-400 mb-1" data-i18n="statusLabel">Status</div>
                                    <div class="text-xl font-bold text-blue-600" data-i18n="statusValue">Stable</div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="space-y-20">
                    <div class="step opacity-100" id="step1">
                        <h3 class="text-4xl font-bold mb-6" data-i18n="step1Title">Innere Stärke.</h3>
                        <p class="text-slate-500 text-lg" data-i18n="step1Copy">Ein massiver Rust-Kern sorgt für Speichersicherheit und Millisekunden-Performance bei Millionen von Datensätzen.</p>
                    </div>
                    <div class="step opacity-20" id="step2">
                        <h3 class="text-4xl font-bold mb-6" data-i18n="step2Title">Äußere Klarheit.</h3>
                        <p class="text-slate-500 text-lg" data-i18n="step2Copy">Das React-Interface bietet eine flüssige, intuitive Erfahrung für komplexe Finanzberichte.</p>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <section class="scroll-section bg-transition" id="dark-section">
        <div class="max-w-7xl mx-auto w-full">
            <div class="grid md:grid-cols-2 gap-20 items-center">
                <div>
                    <h2 class="text-7xl font-bold mb-10 tracking-tighter" data-i18n-html="darkTitle">KEINE CLOUD.<br>KEIN RISIKO.</h2>
                    <p class="text-xl opacity-60 leading-relaxed mb-10" data-i18n-html="darkCopy">NordBund Suite arbeitet <span class="italic">Local-First</span>. Ihre Daten verlassen niemals Ihren Rechner. Wir glauben an absolute Datensouveränität.</p>
                    <div class="inline-block p-1 bg-blue-600 text-white font-bold px-6 py-3 rounded-full" data-i18n="darkBadge">100% OFFLINE CAPABLE</div>
                </div>
                <div class="relative">
                    <div class="aspect-square border border-white/10 rounded-full flex items-center justify-center">
                        <div class="w-1/2 h-1/2 bg-blue-600 rounded-full blur-[120px] opacity-30"></div>
                        <div class="text-9xl relative z-10">🔒</div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <section class="scroll-section" id="download">
        <div class="max-w-7xl mx-auto w-full text-center">
            <h2 class="giant-text font-display mb-20" data-i18n-html="downloadTitle">HOL ES<br>DIR.</h2>
            <div class="flex flex-col md:flex-row justify-center items-center gap-10">
                <a href="https://github.com/oscar1457/NordBund-Suite/releases" class="group relative px-20 py-8 bg-black text-white text-2xl font-bold rounded-full overflow-hidden transition-all hover:scale-105">
                    <span class="relative z-10" data-i18n="downloadCta">DOWNLOAD RELEASE</span>
                    <div class="absolute inset-0 bg-blue-600 translate-y-full group-hover:translate-y-0 transition-transform duration-500"></div>
                </a>
                <div class="text-left font-mono text-sm opacity-40">
                    $ git clone nordbund-suite <br>
                    $ npm run build <br>
                    $ tauri build --target windows
                </div>
            </div>
        </div>
    </section>

    <footer class="p-10 text-center border-t border-slate-100 mt-20">
        <div class="font-bold text-xs tracking-widest uppercase opacity-40" data-i18n="footerText">NordBund Suite // Designed by Quintana // 2026</div>
    </footer>

    <script>
        const translations = {
            de: {
                pageTitle: 'NordBund Suite - Extreme Precision',
                navSource: 'Source',
                navSystem: 'System',
                heroAccent: 'Precision',
                heroCopy: 'Die Suite für <span class="font-bold underline">Schadensanalyse</span>. Kompromisslose Geschwindigkeit durch Rust, absolute Eleganz durch React.',
                heroBuild: 'v1.2.0 Build 2026',
                backendLabel: 'Rust Backend',
                kpiLabel: 'Total KPI',
                statusLabel: 'Status',
                statusValue: 'Stable',
                step1Title: 'Innere Stärke.',
                step1Copy: 'Ein massiver Rust-Kern sorgt für Speichersicherheit und Millisekunden-Performance bei Millionen von Datensätzen.',
                step2Title: 'Äußere Klarheit.',
                step2Copy: 'Das React-Interface bietet eine flüssige, intuitive Erfahrung für komplexe Finanzberichte.',
                darkTitle: 'KEINE CLOUD.<br>KEIN RISIKO.',
                darkCopy: 'NordBund Suite arbeitet <span class="italic">Local-First</span>. Ihre Daten verlassen niemals Ihren Rechner. Wir glauben an absolute Datensouveränität.',
                darkBadge: '100% OFFLINE CAPABLE',
                downloadTitle: 'HOL ES<br>DIR.',
                downloadCta: 'DOWNLOAD RELEASE',
                footerText: 'NordBund Suite // Designed by Quintana // 2026'
            },
            en: {
                pageTitle: 'NordBund Suite - Extreme Precision',
                navSource: 'Source',
                navSystem: 'System',
                heroAccent: 'Precision',
                heroCopy: 'The suite for <span class="font-bold underline">damage analysis</span>. Uncompromising speed with Rust, refined clarity with React.',
                heroBuild: 'v1.2.0 Build 2026',
                backendLabel: 'Rust Backend',
                kpiLabel: 'Total KPI',
                statusLabel: 'Status',
                statusValue: 'Stable',
                step1Title: 'Inner strength.',
                step1Copy: 'A powerful Rust core delivers memory safety and millisecond performance across millions of records.',
                step2Title: 'Outer clarity.',
                step2Copy: 'The React interface provides a fluid, intuitive experience for complex financial reporting.',
                darkTitle: 'NO CLOUD.<br>NO RISK.',
                darkCopy: 'NordBund Suite is <span class="italic">local-first</span>. Your data never leaves your machine. We believe in complete data sovereignty.',
                darkBadge: '100% OFFLINE CAPABLE',
                downloadTitle: 'GET<br>IT.',
                downloadCta: 'DOWNLOAD RELEASE',
                footerText: 'NordBund Suite // Designed by Quintana // 2026'
            }
        };

        const langButtons = document.querySelectorAll('[data-lang]');
        const progressBar = document.getElementById('progress');
        const scrollyTrigger = document.getElementById('scrolly-trigger');
        const darkSection = document.getElementById('dark-section');
        const backLayer = document.getElementById('layer-back');
        const frontLayer = document.getElementById('layer-front');
        const step1 = document.getElementById('step1');
        const step2 = document.getElementById('step2');
        const chartBars = Array.from(document.querySelectorAll('.bar'));

        const INITIAL_BACK_TRANSFORM = 'translateZ(-200px) rotateX(20deg)';
        const INITIAL_FRONT_TRANSFORM = 'translateY(0px) rotateY(0deg)';

        const state = {
            isModalVisible: window.top === window,
            lastScrollY: window.scrollY,
            scrollRaf: null,
            resizeRaf: null,
            metrics: null,
            hasAnimatedBars: false,
            stepTwoActive: false,
            darkModeActive: false,
            progressValue: -1,
            backOpacity: null,
            backTransform: null,
            frontTransform: null
        };

        function clamp(value, min, max) {
            return Math.min(max, Math.max(min, value));
        }

        function computeMetrics() {
            const winHeight = window.innerHeight || 1;
            state.metrics = {
                winHeight,
                docHeight: Math.max(1, document.documentElement.scrollHeight - winHeight),
                triggerOffset: scrollyTrigger.offsetTop,
                triggerHeight: Math.max(1, scrollyTrigger.offsetHeight),
                darkOffset: darkSection.offsetTop,
                darkHeight: Math.max(1, darkSection.offsetHeight)
            };
        }

        function cancelPendingScrollFrame() {
            if (state.scrollRaf !== null) {
                cancelAnimationFrame(state.scrollRaf);
                state.scrollRaf = null;
            }
        }

        function applyLanguage(lang) {
            const dictionary = translations[lang] || translations.de;
            document.documentElement.lang = lang;
            document.title = dictionary.pageTitle;

            document.querySelectorAll('[data-i18n]').forEach((el) => {
                const key = el.getAttribute('data-i18n');
                if (dictionary[key]) {
                    el.textContent = dictionary[key];
                }
            });

            document.querySelectorAll('[data-i18n-html]').forEach((el) => {
                const key = el.getAttribute('data-i18n-html');
                if (dictionary[key]) {
                    el.innerHTML = dictionary[key];
                }
            });

            langButtons.forEach((btn) => {
                btn.classList.toggle('is-active', btn.dataset.lang === lang);
            });

            try {
                localStorage.setItem('nordbund-lang', lang);
            } catch (_) {
                // ignore storage errors
            }
        }

        function resolveInitialLanguage() {
            let storedLang = null;
            try {
                storedLang = localStorage.getItem('nordbund-lang');
            } catch (_) {
                storedLang = null;
            }

            if (storedLang === 'de' || storedLang === 'en') {
                return storedLang;
            }

            try {
                const parentLang = window.parent && window.parent.document ? window.parent.document.documentElement.lang : null;
                if (parentLang && parentLang.toLowerCase().startsWith('en')) {
                    return 'en';
                }
            } catch (_) {
                // ignore cross-frame errors
            }

            return 'de';
        }

        function updateScrollEffects(scrollPos) {
            if (!state.metrics) {
                computeMetrics();
            }
            const metrics = state.metrics;

            const progress = clamp(scrollPos / metrics.docHeight, 0, 1);
            if (Math.abs(progress - state.progressValue) > 0.001) {
                progressBar.style.transform = `scaleX(${progress})`;
                state.progressValue = progress;
            }

            const triggerStart = metrics.triggerOffset;
            const triggerEnd = triggerStart + metrics.triggerHeight;
            const isInsideScrolly = scrollPos > triggerStart && scrollPos < triggerEnd;

            if (isInsideScrolly) {
                const sectionProgress = clamp((scrollPos - triggerStart) / metrics.triggerHeight, 0, 1);

                if (sectionProgress > 0.1) {
                    const backOpacity = String(Math.min(1, sectionProgress * 1.5));
                    const backTransform = `translateZ(-200px) rotateX(20deg) translateY(${sectionProgress * -100}px) translateX(${sectionProgress * -100}px)`;
                    const frontTransform = `translateY(${sectionProgress * 50}px) rotateY(${sectionProgress * 10}deg)`;

                    if (state.backOpacity !== backOpacity) {
                        backLayer.style.opacity = backOpacity;
                        state.backOpacity = backOpacity;
                    }
                    if (state.backTransform !== backTransform) {
                        backLayer.style.transform = backTransform;
                        state.backTransform = backTransform;
                    }
                    if (state.frontTransform !== frontTransform) {
                        frontLayer.style.transform = frontTransform;
                        state.frontTransform = frontTransform;
                    }
                } else {
                    if (state.backOpacity !== '0') {
                        backLayer.style.opacity = '0';
                        state.backOpacity = '0';
                    }
                    if (state.backTransform !== INITIAL_BACK_TRANSFORM) {
                        backLayer.style.transform = INITIAL_BACK_TRANSFORM;
                        state.backTransform = INITIAL_BACK_TRANSFORM;
                    }
                    if (state.frontTransform !== INITIAL_FRONT_TRANSFORM) {
                        frontLayer.style.transform = INITIAL_FRONT_TRANSFORM;
                        state.frontTransform = INITIAL_FRONT_TRANSFORM;
                    }
                }

                if (sectionProgress > 0.3 && !state.hasAnimatedBars) {
                    chartBars.forEach((bar) => {
                        bar.style.height = bar.style.getPropertyValue('--h');
                    });
                    state.hasAnimatedBars = true;
                }

                const stepTwoShouldBeActive = sectionProgress > 0.5;
                if (stepTwoShouldBeActive !== state.stepTwoActive) {
                    step1.style.opacity = stepTwoShouldBeActive ? '0.2' : '1';
                    step2.style.opacity = stepTwoShouldBeActive ? '1' : '0.2';
                    state.stepTwoActive = stepTwoShouldBeActive;
                }
            }

            const shouldUseDarkMode =
                scrollPos > metrics.darkOffset - metrics.winHeight / 2 &&
                scrollPos < metrics.darkOffset + metrics.darkHeight;

            if (shouldUseDarkMode !== state.darkModeActive) {
                document.body.classList.toggle('dark-mode', shouldUseDarkMode);
                state.darkModeActive = shouldUseDarkMode;
            }
        }

        function requestScrollUpdate() {
            state.lastScrollY = window.scrollY;
            if (!state.isModalVisible || document.visibilityState !== 'visible') {
                return;
            }
            if (state.scrollRaf !== null) return;

            state.scrollRaf = requestAnimationFrame(() => {
                state.scrollRaf = null;
                updateScrollEffects(state.lastScrollY);
            });
        }

        function handleResize() {
            if (state.resizeRaf !== null) {
                cancelAnimationFrame(state.resizeRaf);
            }
            state.resizeRaf = requestAnimationFrame(() => {
                state.resizeRaf = null;
                computeMetrics();
                requestScrollUpdate();
            });
        }

        window.addEventListener('scroll', requestScrollUpdate, { passive: true });
        window.addEventListener('resize', handleResize, { passive: true });
        window.addEventListener('orientationchange', handleResize, { passive: true });

        window.addEventListener('message', (event) => {
            const data = event && event.data ? event.data : null;
            if (!data || data.type !== 'portfolio:modal-visibility') return;
            if (data.modal && data.modal !== 'nordbund') return;
            state.isModalVisible = !!data.visible;
            if (state.isModalVisible) {
                requestScrollUpdate();
            } else {
                cancelPendingScrollFrame();
            }
        });

        document.addEventListener('visibilitychange', () => {
            if (document.visibilityState === 'visible') {
                requestScrollUpdate();
            } else {
                cancelPendingScrollFrame();
            }
        });

        chartBars.forEach((bar) => {
            bar.addEventListener('mouseenter', () => {
                bar.style.background = '#000';
            });
            bar.addEventListener('mouseleave', () => {
                bar.style.background = '#2563eb';
            });
        });

        langButtons.forEach((btn) => {
            btn.addEventListener('click', () => {
                applyLanguage(btn.dataset.lang);
            });
        });

        computeMetrics();
        applyLanguage(resolveInitialLanguage());
        requestScrollUpdate();
    </script>
</body>
</html>
